!function(){"use strict";var t={134:function(t,e){e.Z='<div class="wrapper"> <div class="container"> <div class="basket"> <div class="basket__header"> <h2 class="basket__title">Корзина</h2> <p class="basket__count"> Товаров на странице: <input class="basket__count-number" type="number" value="5" min="1" step="1"/> </p> <p class="basket__page"> Страница: <button class="basket__page-left cart__button">&lt;</button> <span class="basket_page-number">1</span> <button class="basket__page-right cart__button">&gt;</button> </p> </div> <ul class="basket__list"></ul> </div> <div class="summary"> <input class="summary__promo" type="text" placeholder="Введите промокод"/> <p class="promo-for-test">Promo for test: \'RS\', \'VladiMish\'</p> <button class="button summary__button">Оформить заказ</button> </div> </div> </div> '},879:function(t,e,s){t.exports=s.p+"assets/ae-logo.png"},978:function(t,e,s){t.exports=s.p+"assets/cart_logo.svg"},14:function(t,e,s){t.exports=s.p+"assets/empty-card.png"},866:function(t,e,s){t.exports=s.p+"assets/github.svg"},354:function(t,e,s){t.exports=s.p+"assets/grid-icon.svg"},449:function(t,e,s){t.exports=s.p+"assets/icon-copy.svg"},693:function(t,e,s){t.exports=s.p+"assets/icon-refresh.svg"},777:function(t,e,s){t.exports=s.p+"assets/mastercard-logo.png"},84:function(t,e,s){t.exports=s.p+"assets/pepper1.svg"},80:function(t,e,s){t.exports=s.p+"assets/pepper2.svg"},278:function(t,e,s){t.exports=s.p+"assets/rs_school_js.svg"},649:function(t,e,s){t.exports=s.p+"assets/site_logo.svg"},35:function(t,e,s){t.exports=s.p+"assets/visa-logo.png"},120:function(t,e,s){t.exports=s.p+"assets/wide-icon.svg"},585:function(t,e,s){t.exports=s.p+"assets/metr404.png"}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var c=e[i]={exports:{}};return t[i](c,c.exports,s),c.exports}s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t}(),function(){s.p;class t{constructor(){this._componentElement=document.createElement("div")}createComponent(){const t=document.createElement("div");t.className="dark-block",t.addEventListener("click",(()=>{this._componentElement.remove()})),this._componentElement.append(t);const e=document.createElement("div");return e.className="registr",e.append(this.createForm()),this._componentElement.append(e),this._componentElement}createForm(){const e=document.createElement("form");e.className="registr__form";const i=document.createElement("h2");i.className="registr__details",i.innerText="Личные данные",e.append(i);const n=document.createElement("label");n.className="input__label label_wrong";const a=document.createElement("span");n.prepend(a);let r=document.createElement("input");r.type="text",r.className="input input-name",r.placeholder="Имя и фамилия",r.addEventListener("input",(function(){const e=this.value.split(" ");if(e.length>1&&e.every((t=>t.length>2)))return t.valid.name=!0,void(a.innerText="");t.valid.name=!1,a.innerText="Имя и фамилия введены неправильно"})),n.append(r),e.append(n);const o=document.createElement("label");o.className="input__label label_wrong";const m=document.createElement("span");o.prepend(m),r=document.createElement("input"),r.type="text",r.className="input input-number",r.placeholder="Номер телефона",r.addEventListener("input",(function(){if("+"===this.value[0]&&this.value.length>8&&this.value.split("").slice(1).every((t=>"1234567890".indexOf(t)>-1)))return t.valid.number=!0,void(m.innerText="");t.valid.number=!1,m.innerText="Номер введен неправильно"})),o.append(r),e.append(o);const p=document.createElement("label");p.className="input__label label_wrong";const l=document.createElement("span");p.prepend(l),r=document.createElement("input"),r.type="text",r.className="input input-address",r.placeholder="Адрес",r.addEventListener("input",(function(){const e=this.value.split(" ");if(e.length>2&&e.every((t=>t.length>4)))return t.valid.address=!0,void(l.innerText="");t.valid.address=!1,l.innerText="Адрес введен неправильно"})),p.append(r),e.append(p);const d=document.createElement("label");d.className="input__label label_wrong";const u=document.createElement("span");d.prepend(u),r=document.createElement("input"),r.type="email",r.className="input input-mail",r.placeholder="Email",r.pattern="[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$",r.addEventListener("input",(function(){if(this.checkValidity())return t.valid.email=!0,void(u.innerText="");t.valid.email=!1,u.innerText="Email введен неправильно"})),d.append(r),e.append(d);const h=document.createElement("h3");h.className="card__details",h.innerText="Данные карты",e.append(h);const g=document.createElement("div");g.className="card";const _=document.createElement("label");_.className="card__label";const b=new Image;b.src=s(14),b.alt="empty-card",b.className="card__img",_.append(b),r=document.createElement("input"),r.type="text",r.className="card-input card__number",r.placeholder="Номер карты",r.addEventListener("keydown",(function(e){if(-1!=="1234567890".indexOf(e.key)||"Backspace"==e.key){if(15===this.value.length||"Backspace"===e.key&&17===this.value.length)return t.valid.cardNumber=!0,void(y.innerText="");t.valid.cardNumber=!1,y.innerText="Номер карты введен неправильно"}else e.preventDefault()})),r.addEventListener("input",(function(){switch(this.value[0]){case"3":b.src=s(879);break;case"4":b.src=s(35);break;case"5":b.src=s(777);break;default:b.src=s(14)}})),_.append(r),g.append(_);const v=document.createElement("div");v.className="card__block";const E=document.createElement("label");E.className="card__label",r=document.createElement("input"),r.type="text",r.className="card-input card__date",r.placeholder="Дата",r.addEventListener("keydown",(function(t){-1!=="1234567890".indexOf(t.key)||"Backspace"==t.key||t.preventDefault()})),r.addEventListener("input",(function(){if(4===this.value.length&&-1===this.value.indexOf("/")||5===this.value.length&&this.value.indexOf("/")>-1){let e,s;if(this.value.indexOf("/")>-1?(e=this.value.split("/")[0],s=this.value.split("/")[1]):(e=this.value[0]+this.value[1],s=this.value[2]+this.value[3]),this.value=e+"/"+s,+e<=12&&+s<=31)return t.valid.date=!0,void(C.innerText="")}t.valid.cvv=!1,C.innerText="Дата введена неправильно"})),E.append(r),v.append(E);const f=document.createElement("label");f.className="card__label",r=document.createElement("input"),r.type="text",r.className="card-input card__cvv",r.placeholder="CVV",r.addEventListener("keydown",(function(e){if(-1!=="1234567890".indexOf(e.key)||"Backspace"==e.key){if(2===this.value.length||"Backspace"===e.key&&4===this.value.length)return t.valid.cvv=!0,void(w.innerText="");t.valid.cvv=!1,w.innerText="CVV введен неправильно"}else e.preventDefault()})),f.append(r),v.append(f),g.append(v),e.append(g);const y=document.createElement("p");y.className="card_wrong",e.append(y);const C=document.createElement("p");C.className="card_wrong",e.append(C);const w=document.createElement("p");w.className="card_wrong",e.append(w);const k=document.createElement("p");k.className="card_true",e.append(k);const L=document.createElement("input");return L.type="submit",L.className="button registr__submit",L.value="Подтвердить",L.addEventListener("click",(function(e){e.preventDefault();let s=!0;t.valid.name||(a.innerText="Имя и фамилия введены неправильно",s=!1),t.valid.number||(m.innerText="Номер введен неправильно",s=!1),t.valid.address||(l.innerText="Адрес введен неправильно",s=!1),t.valid.email||(u.innerText="Email введен неправильно",s=!1),t.valid.cardNumber||(y.innerText="Номер карты введен неправильно",s=!1),t.valid.date||(C.innerText="Дата введена неправильно",s=!1),t.valid.cvv||(w.innerText="CVV введен неправильно",s=!1),s?(k.innerText="Заказ оформлен",setTimeout((()=>{c.clearItemList(),window.location.hash="#"}),3e3)):k.innerText=""})),e.append(L),e}}t.valid={name:!1,number:!1,address:!1,email:!1,cardNumber:!1,date:!1,cvv:!1};var e=t;class i{constructor(){this.html=s(134).Z,this.rubleSymbol=" &#8381;"}getHeader(t){i._header=t}createComponent(){const t=document.querySelector(".main-basket");if(t?this._componentElement=t:(this._componentElement=document.createElement("div"),this._componentElement.className="main main-basket"),this._componentElement.innerHTML=this.html,this._componentElement.querySelector(".basket__count-number").value=i.pageItemCount.toString(),this._componentElement.querySelector(".basket_page-number").innerText=i.currentPage.toString(),0===i.itemList.length){const t=document.createElement("p");t.innerText="Здесь пока что ничего нет.",t.classList.add("nothing"),this._componentElement.innerHTML="",this._componentElement.append(t)}else this.createItemList(),this.createSummary(),this.addListeners();return localStorage.getItem("doModale")&&(this._componentElement.append((new e).createComponent()),localStorage.removeItem("doModale")),this._componentElement}addListeners(){this._componentElement.querySelector(".basket__count-number").addEventListener("change",(function(){+this.value<1&&(this.value="1"),i.pageItemCount=+this.value,(new i).rebuild()})),this._componentElement.querySelector(".summary__button").addEventListener("click",(function(){document.querySelector(".main")?.append((new e).createComponent())})),this._componentElement.querySelector(".basket__page-left")?.addEventListener("click",(()=>{i.currentPage-1<1||(i.currentPage-=1,(new i).rebuild())})),this._componentElement.querySelector(".basket__page-right")?.addEventListener("click",(()=>{i.currentPage+1>i.pageCount||(i.currentPage+=1,(new i).rebuild())})),new class{constructor(t,e){this.promo={rs:{name:"RS School",sale:10},vladimish:{name:"VladiMish",sale:20}},this.promoUsed={rs:!1,vladimish:!1},this.sale=0,this.summaryWithSale=0,this.rubleSymbol=" &#8381;",this.promoInput=t.querySelector(".summary__promo"),this.summaryDiv=t.querySelector(".summary__total"),this.summary=e}addListener(){this.promoInput.addEventListener("input",(()=>{this.checkForPromo()}))}checkForPromo(){const t=this.promoInput.value.toLowerCase();if(this.promoDiv&&this.promoDiv.remove(),Object.keys(this.promo).indexOf(t)>-1){this.promoDiv=document.createElement("div"),this.promoDiv.className="promo";const e=document.createElement("span");if(e.innerText=this.promo[t].name+" - "+this.promo[t].sale+"%",this.promoDiv.append(e),!this.promoUsed[t]){const e=document.createElement("button");e.className="promo__button",e.innerText="Добавить",e.addEventListener("click",(()=>{this.createPromo(t,e)})),this.promoDiv.append(e)}this.promoInput.after(this.promoDiv)}}createPromo(t,e){e.remove(),this.promoUsed[t]=!0;const s=document.createElement("div");s.className="promo_added";const i=document.createElement("span");i.innerText=this.promo[t].name+" - "+this.promo[t].sale+"%",s.append(i);const n=document.createElement("button");n.className="promo__button",n.innerText="Удалить",n.addEventListener("click",(()=>{this.deletePromo(s,t)})),s.append(n),this.promoInput.before(s),this.sale+=this.promo[t].sale/100,this.summaryWithSale=this.summary*(1-this.sale),c._header.updateState(this.summaryWithSale,c.productsCount),this.summaryWithSaleDiv||(this.summaryWithSaleDiv=document.createElement("p"),this.summaryWithSaleDiv.className="summary-with-sale"),this.summaryWithSaleDiv.innerHTML="Итого: "+this.summaryWithSale+" "+this.rubleSymbol,this.summaryDiv.after(this.summaryWithSaleDiv),this.summaryDiv.classList.add("summary_old")}deletePromo(t,e){t.remove(),this.promoUsed[e]=!1,this.checkForPromo(),this.sale-=this.promo[e].sale/100,this.summaryWithSale=Math.floor(this.summary*(1-this.sale)),c._header.updateState(this.summaryWithSale,c.productsCount),this.summaryWithSale===this.summary?(this.summaryDiv.classList.remove("summary_old"),this.summaryWithSaleDiv.remove()):this.summaryWithSaleDiv.innerHTML="Итого: "+this.summaryWithSale+" "+this.rubleSymbol}}(this._componentElement,i.productSummary).addListener()}createItemList(){const t=this._componentElement.querySelector(".basket__list");i.pageCount=Math.ceil(i.itemList.length/i.pageItemCount);const e=i.pageItemCount*(i.currentPage-1),s=i.currentPage===i.pageCount?i.itemList.length:i.pageItemCount*i.currentPage;for(let n=e;n<s;n++)t?.append(this.createItem(i.itemList[n].product,n+1,i.itemList[n].count))}createSummary(){i.productSummary=0,i.itemList.forEach((t=>{i.productSummary+=t.count*t.product.price}));const t=this._componentElement.querySelector(".summary"),e=document.createElement("p");e.classList.add("summary__total"),e.innerHTML="Итого: "+i.productSummary+" "+this.rubleSymbol,t?.prepend(e);const s=document.createElement("p");s.classList.add("summary__count"),s.innerText="Количество: "+i.productsCount,t?.prepend(s)}createItem(t,e,s){const n=document.createElement("li");n.classList.add("cart-item"),n.dataset.index=t.id.toString();const c=document.createElement("div");c.classList.add("cart-item__info");const a=document.createElement("a");a.href=`#products/${t.id}`,a.className="cart-item__link",a.append(c);const r=document.createElement("p");r.classList.add("cart-item__number"),r.innerText=e.toString(),c.append(r);const o=new Image;t.thumbnail?o.src=t.thumbnail:o.src="#",o.alt="photo",o.className="cart-item__img",c.append(o);const m=document.createElement("div");m.className="cart-item__desc";const p=document.createElement("p");p.classList.add("cart-item__name"),p.innerText=t.title,m.append(p);const l=document.createElement("p");l.classList.add("cart-item__category"),l.innerText="Категория: "+t.category,m.append(l);const d=document.createElement("p");d.classList.add("cart-item__vehicle"),d.innerText="Базовая машина: "+t.baseVehicle,m.append(d),c.append(m),n.append(a);const u=document.createElement("div");u.classList.add("cart-item__aside");const h=document.createElement("p");h.classList.add("cart-item__max-amount"),h.innerText="Осталось: "+(t.stock-s),u.append(h);const g=document.createElement("div");g.classList.add("cart-item__controls");const _=document.createElement("button");_.classList.add("cart-item__less"),_.classList.add("cart__button"),_.innerText="-",_.dataset.index=t.id.toString(),_.addEventListener("click",(function(){const t=this.dataset.index;i.deleteItem(+t);const e=new i;i.currentPage=1,e.rebuild()})),g.append(_);const b=document.createElement("span");b.classList.add("cart-item__amount"),b.innerText=s.toString(),g.append(b);const v=document.createElement("button");v.classList.add("cart-item__more"),v.classList.add("cart__button"),v.innerText="+",v.dataset.index=t.id.toString(),v.addEventListener("click",(function(){const t=this.dataset.index;let e=i.itemList.find((e=>e.product.id===+t));e&&i.addItem(e.product),(new i).rebuild()})),g.append(v),u.append(g);const E=document.createElement("p");return E.classList.add("cart-item__price"),E.innerHTML=t.price*s+this.rubleSymbol,u.append(E),n.append(u),n}static addItem(t){const e=this.itemList.find((e=>e.product.id===t.id));let s=0;e&&(s=e.count),s+1<=t.stock&&(0===s?this.itemList.push({count:s+1,product:t}):this.itemList[this.itemList.findIndex((e=>e.product.id===t.id))].count++,this.productsCount++,this.calculateSummary()),this.saveValues(),i._header.updateState(this.productSummary,this.productsCount)}static deleteItem(t){const e=this.itemList.find((e=>e.product.id===t));if(e){if(e.count>1)e.count--;else{const t=this.itemList.indexOf(e);this.itemList.splice(t,1)}this.productsCount--,this.calculateSummary(),this.saveValues(),i._header.updateState(this.productSummary,this.productsCount)}}static clearItemList(){i.itemList=[]}static isInCart(t){return!!this.itemList.find((e=>e.product.id===t))}static setValues(){localStorage.getItem("itemList")&&(this.itemList=JSON.parse(localStorage.getItem("itemList"))),localStorage.getItem("productSummary")&&(this.productSummary=JSON.parse(localStorage.getItem("productSummary"))),localStorage.getItem("productsCount")&&(this.productsCount=JSON.parse(localStorage.getItem("productsCount")))}static calculateSummary(){this.productSummary=0,this.itemList.forEach((t=>{this.productSummary+=t.count*t.product.price}))}static saveValues(){localStorage.setItem("itemList",JSON.stringify(this.itemList)),localStorage.setItem("productSummary",JSON.stringify(this.productSummary)),localStorage.setItem("productsCount",JSON.stringify(this.productsCount))}rebuild(){this.createComponent()}}i.itemList=[],i.productsCount=0,i.productSummary=0,i.pageItemCount=5,i.pageCount=1,i.currentPage=1;var n,c=i;!function(t){t.Category="category",t.Stock="stock",t.Price="price",t.BaseVehicle="baseVehicle"}(n||(n={}));var a=n,r=JSON.parse('[{"id":1,"title":"Ковш VM J","description":"Ковш применяется для разработки котлованов, карьеров в грунтах I-IV категорий и разгрузки сыпучих материалов, плотность до 1600 кг/м3 (песок, суглинок, растительный грунт, щебень).","price":81000,"stock":11,"baseVehicle":"John Deere","category":"Ковши экскаваторные","thumbnail":"https://i.imgur.com/TAHhLzs.jpg","images":["https://i.imgur.com/ZqT5tBa.jpg","https://i.imgur.com/wrHKJlY.jpg","https://i.imgur.com/sVC1Nv9.jpg","https://i.imgur.com/P3lwyYJ.jpg","https://i.imgur.com/p03QHwR.jpg"]},{"id":2,"title":"Рабочее оборудование VM J","description":"Стандартное навесное оборудование необходимо для выполнения операций с грунтами средней плотности. ","price":300000,"stock":3,"baseVehicle":"JCB","category":"Стрелы, рукояти","thumbnail":"https://i.imgur.com/VCrzjYe.jpg","images":["https://i.imgur.com/hQkjGEx.jpg","https://i.imgur.com/P2HvbTG.jpg","https://i.imgur.com/AamO4HT.jpg"]},{"id":3,"title":"Оси, пальцы втулки VM C","description":"Пальцы (оси) для экскаваторов строительного класса (эксплуатационной массой до 75 тонн) производятся из стали 40Х.","price":990000,"stock":4,"baseVehicle":"Caterpillar","category":"Оси, втулки","thumbnail":"https://i.imgur.com/cyO8AIx.jpg","images":["https://i.imgur.com/4kb2ISw.jpg","https://i.imgur.com/rVutm8s.jpg"]},{"id":4,"title":"Ковш VM K","description":"Ковш применяется для разработки котлованов, карьеров в грунтах I-IV категорий и разгрузки сыпучих материалов, плотность до 1600 кг/м3 (песок, суглинок, растительный грунт, щебень).","price":45000,"stock":9,"baseVehicle":"Komatsu","category":"Ковши экскаваторные","thumbnail":"https://i.imgur.com/TAHhLzs.jpg","images":["https://i.imgur.com/ZqT5tBa.jpg","https://i.imgur.com/wrHKJlY.jpg","https://i.imgur.com/sVC1Nv9.jpg","https://i.imgur.com/P3lwyYJ.jpg","https://i.imgur.com/p03QHwR.jpg"]},{"id":5,"title":"Отвал VM D","description":"Отвал – ключевой механизм любой бульдозерной машины. Изготовленный из стали повышенной прочности и имеющий изогнутый эргономичный профиль основной рабочий инструмент дает возможность быстро выполнять задачи различной сложности во время строительно-дорожных, коммунальных и других работ.","price":960000,"stock":11,"baseVehicle":"Doosan","category":"Бульдозерные отвалы","thumbnail":"https://i.imgur.com/U0zfprB.jpg","images":["https://i.imgur.com/6Qf1pem.jpg","https://i.imgur.com/qsOF72u.jpg"]},{"id":6,"title":"Оси, пальцы втулки VM C","description":"Пальцы (оси) для экскаваторов строительного класса (эксплуатационной массой до 75 тонн) производятся из стали 40Х.","price":70000,"stock":4,"baseVehicle":"Case","category":"Оси, втулки","thumbnail":"https://i.imgur.com/cyO8AIx.jpg","images":["https://i.imgur.com/4kb2ISw.jpg","https://i.imgur.com/rVutm8s.jpg"]},{"id":7,"title":"Система зубьев VM C","description":"В наличии и под заказ широкий спектр запасных частей на спецтехнику различных серий и модификаций.","price":71000,"stock":2,"baseVehicle":"Caterpillar","category":"Коронки, адаптеры","thumbnail":"https://i.imgur.com/i92H2II.jpg","images":["https://i.imgur.com/BTaMcia.jpg","https://i.imgur.com/Fu6vQuO.jpg"]},{"id":8,"title":"Оси, пальцы втулки VM J","description":"Пальцы (оси) для экскаваторов строительного класса (эксплуатационной массой до 75 тонн) производятся из стали 40Х.","price":210000,"stock":11,"baseVehicle":"John Deere","category":"Оси, втулки","thumbnail":"https://i.imgur.com/cyO8AIx.jpg","images":["https://i.imgur.com/4kb2ISw.jpg","https://i.imgur.com/rVutm8s.jpg"]},{"id":9,"title":"Система зубьев VM C","description":"В наличии и под заказ широкий спектр запасных частей на спецтехнику различных серий и модификаций.","price":57000,"stock":11,"baseVehicle":"Caterpillar","category":"Коронки, адаптеры","thumbnail":"https://i.imgur.com/i92H2II.jpg","images":["https://i.imgur.com/BTaMcia.jpg","https://i.imgur.com/Fu6vQuO.jpg"]},{"id":10,"title":"Система зубьев VM D","description":"В наличии и под заказ широкий спектр запасных частей на спецтехнику различных серий и модификаций.","price":42000,"stock":4,"baseVehicle":"Doosan","category":"Коронки, адаптеры","thumbnail":"https://i.imgur.com/i92H2II.jpg","images":["https://i.imgur.com/BTaMcia.jpg","https://i.imgur.com/Fu6vQuO.jpg"]},{"id":11,"title":"Отвал VM C","description":"Отвал – ключевой механизм любой бульдозерной машины. Изготовленный из стали повышенной прочности и имеющий изогнутый эргономичный профиль основной рабочий инструмент дает возможность быстро выполнять задачи различной сложности во время строительно-дорожных, коммунальных и других работ.","price":750000,"stock":12,"baseVehicle":"Caterpillar","category":"Бульдозерные отвалы","thumbnail":"https://i.imgur.com/U0zfprB.jpg","images":["https://i.imgur.com/6Qf1pem.jpg","https://i.imgur.com/qsOF72u.jpg"]},{"id":12,"title":"Отвал VM D","description":"Отвал – ключевой механизм любой бульдозерной машины. Изготовленный из стали повышенной прочности и имеющий изогнутый эргономичный профиль основной рабочий инструмент дает возможность быстро выполнять задачи различной сложности во время строительно-дорожных, коммунальных и других работ.","price":720000,"stock":12,"baseVehicle":"Doosan","category":"Бульдозерные отвалы","thumbnail":"https://i.imgur.com/U0zfprB.jpg","images":["https://i.imgur.com/6Qf1pem.jpg","https://i.imgur.com/qsOF72u.jpg"]},{"id":13,"title":"Оси, пальцы втулки VM H","description":"Пальцы (оси) для экскаваторов строительного класса (эксплуатационной массой до 75 тонн) производятся из стали 40Х.","price":100000,"stock":6,"baseVehicle":"Hitachi","category":"Оси, втулки","thumbnail":"https://i.imgur.com/cyO8AIx.jpg","images":["https://i.imgur.com/4kb2ISw.jpg","https://i.imgur.com/rVutm8s.jpg"]},{"id":14,"title":"Отвал VM V","description":"Отвал – ключевой механизм любой бульдозерной машины. Изготовленный из стали повышенной прочности и имеющий изогнутый эргономичный профиль основной рабочий инструмент дает возможность быстро выполнять задачи различной сложности во время строительно-дорожных, коммунальных и других работ.","price":740000,"stock":8,"baseVehicle":"Volvo","category":"Бульдозерные отвалы","thumbnail":"https://i.imgur.com/U0zfprB.jpg","images":["https://i.imgur.com/6Qf1pem.jpg","https://i.imgur.com/qsOF72u.jpg"]},{"id":15,"title":"Рабочее оборудование VM V","description":"Стандартное навесное оборудование необходимо для выполнения операций с грунтами средней плотности. ","price":360000,"stock":8,"baseVehicle":"Volvo","category":"Стрелы, рукояти","thumbnail":"https://i.imgur.com/VCrzjYe.jpg","images":["https://i.imgur.com/hQkjGEx.jpg","https://i.imgur.com/P2HvbTG.jpg","https://i.imgur.com/AamO4HT.jpg"]},{"id":16,"title":"Система зубьев VM L","description":"В наличии и под заказ широкий спектр запасных частей на спецтехнику различных серий и модификаций.","price":45000,"stock":6,"baseVehicle":"Liebherr","category":"Коронки, адаптеры","thumbnail":"https://i.imgur.com/i92H2II.jpg","images":["https://i.imgur.com/BTaMcia.jpg","https://i.imgur.com/Fu6vQuO.jpg"]},{"id":17,"title":"Рабочее оборудование VM V","description":"Стандартное навесное оборудование необходимо для выполнения операций с грунтами средней плотности. ","price":320000,"stock":11,"baseVehicle":"Volvo","category":"Стрелы, рукояти","thumbnail":"https://i.imgur.com/VCrzjYe.jpg","images":["https://i.imgur.com/hQkjGEx.jpg","https://i.imgur.com/P2HvbTG.jpg","https://i.imgur.com/AamO4HT.jpg"]},{"id":18,"title":"Система зубьев VM J","description":"В наличии и под заказ широкий спектр запасных частей на спецтехнику различных серий и модификаций.","price":25000,"stock":7,"baseVehicle":"JCB","category":"Коронки, адаптеры","thumbnail":"https://i.imgur.com/i92H2II.jpg","images":["https://i.imgur.com/BTaMcia.jpg","https://i.imgur.com/Fu6vQuO.jpg"]},{"id":19,"title":"Отвал VM L","description":"Отвал – ключевой механизм любой бульдозерной машины. Изготовленный из стали повышенной прочности и имеющий изогнутый эргономичный профиль основной рабочий инструмент дает возможность быстро выполнять задачи различной сложности во время строительно-дорожных, коммунальных и других работ.","price":530000,"stock":9,"baseVehicle":"Liebherr","category":"Бульдозерные отвалы","thumbnail":"https://i.imgur.com/U0zfprB.jpg","images":["https://i.imgur.com/6Qf1pem.jpg","https://i.imgur.com/qsOF72u.jpg"]},{"id":20,"title":"Оси, пальцы втулки VM K","description":"Пальцы (оси) для экскаваторов строительного класса (эксплуатационной массой до 75 тонн) производятся из стали 40Х.","price":540000,"stock":7,"baseVehicle":"Komatsu","category":"Оси, втулки","thumbnail":"https://i.imgur.com/cyO8AIx.jpg","images":["https://i.imgur.com/4kb2ISw.jpg","https://i.imgur.com/rVutm8s.jpg"]},{"id":21,"title":"Гусеничная цепь VM C","description":"Прямые поставки комплектующих для спецтехники брендов KMF, ITM, USCO более 10 лет и всегда имеет большой ассортимент продукции в наличии на своих складах.","price":680000,"stock":6,"baseVehicle":"Case","category":"Ходовая часть","thumbnail":"https://i.imgur.com/ewuCfwC.jpg","images":["https://i.imgur.com/wcVOdDS.jpg","https://i.imgur.com/Ujg8Uee.jpg"]},{"id":22,"title":"Рабочее оборудование VM K","description":"Стандартное навесное оборудование необходимо для выполнения операций с грунтами средней плотности. ","price":230000,"stock":2,"baseVehicle":"Komatsu","category":"Стрелы, рукояти","thumbnail":"https://i.imgur.com/VCrzjYe.jpg","images":["https://i.imgur.com/hQkjGEx.jpg","https://i.imgur.com/P2HvbTG.jpg","https://i.imgur.com/AamO4HT.jpg"]},{"id":23,"title":"Ковш VM C","description":"Ковш применяется для разработки котлованов, карьеров в грунтах I-IV категорий и разгрузки сыпучих материалов, плотность до 1600 кг/м3 (песок, суглинок, растительный грунт, щебень).","price":68000,"stock":12,"baseVehicle":"Caterpillar","category":"Ковши экскаваторные","thumbnail":"https://i.imgur.com/TAHhLzs.jpg","images":["https://i.imgur.com/ZqT5tBa.jpg","https://i.imgur.com/wrHKJlY.jpg","https://i.imgur.com/sVC1Nv9.jpg","https://i.imgur.com/P3lwyYJ.jpg","https://i.imgur.com/p03QHwR.jpg"]},{"id":24,"title":"Оси, пальцы втулки VM L","description":"Пальцы (оси) для экскаваторов строительного класса (эксплуатационной массой до 75 тонн) производятся из стали 40Х.","price":770000,"stock":3,"baseVehicle":"Liebherr","category":"Оси, втулки","thumbnail":"https://i.imgur.com/cyO8AIx.jpg","images":["https://i.imgur.com/4kb2ISw.jpg","https://i.imgur.com/rVutm8s.jpg"]},{"id":25,"title":"Система зубьев VM D","description":"В наличии и под заказ широкий спектр запасных частей на спецтехнику различных серий и модификаций.","price":94000,"stock":5,"baseVehicle":"Doosan","category":"Коронки, адаптеры","thumbnail":"https://i.imgur.com/i92H2II.jpg","images":["https://i.imgur.com/BTaMcia.jpg","https://i.imgur.com/Fu6vQuO.jpg"]},{"id":26,"title":"Гусеничная цепь VM J","description":"Прямые поставки комплектующих для спецтехники брендов KMF, ITM, USCO более 10 лет и всегда имеет большой ассортимент продукции в наличии на своих складах.","price":300000,"stock":4,"baseVehicle":"JCB","category":"Ходовая часть","thumbnail":"https://i.imgur.com/ewuCfwC.jpg","images":["https://i.imgur.com/wcVOdDS.jpg","https://i.imgur.com/Ujg8Uee.jpg"]},{"id":27,"title":"Система зубьев VM H","description":"В наличии и под заказ широкий спектр запасных частей на спецтехнику различных серий и модификаций.","price":10000,"stock":3,"baseVehicle":"Hitachi","category":"Коронки, адаптеры","thumbnail":"https://i.imgur.com/i92H2II.jpg","images":["https://i.imgur.com/BTaMcia.jpg","https://i.imgur.com/Fu6vQuO.jpg"]},{"id":28,"title":"Оси, пальцы втулки VM L","description":"Пальцы (оси) для экскаваторов строительного класса (эксплуатационной массой до 75 тонн) производятся из стали 40Х.","price":420000,"stock":8,"baseVehicle":"Liebherr","category":"Оси, втулки","thumbnail":"https://i.imgur.com/cyO8AIx.jpg","images":["https://i.imgur.com/4kb2ISw.jpg","https://i.imgur.com/rVutm8s.jpg"]},{"id":29,"title":"Система зубьев VM D","description":"В наличии и под заказ широкий спектр запасных частей на спецтехнику различных серий и модификаций.","price":76000,"stock":6,"baseVehicle":"Doosan","category":"Коронки, адаптеры","thumbnail":"https://i.imgur.com/i92H2II.jpg","images":["https://i.imgur.com/BTaMcia.jpg","https://i.imgur.com/Fu6vQuO.jpg"]},{"id":30,"title":"Рабочее оборудование VM L","description":"Стандартное навесное оборудование необходимо для выполнения операций с грунтами средней плотности. ","price":970000,"stock":6,"baseVehicle":"Liebherr","category":"Стрелы, рукояти","thumbnail":"https://i.imgur.com/VCrzjYe.jpg","images":["https://i.imgur.com/hQkjGEx.jpg","https://i.imgur.com/P2HvbTG.jpg","https://i.imgur.com/AamO4HT.jpg"]},{"id":31,"title":"Гусеничная цепь VM К","description":"Прямые поставки комплектующих для спецтехники брендов KMF, ITM, USCO более 10 лет и всегда имеет большой ассортимент продукции в наличии на своих складах.","price":180000,"stock":9,"baseVehicle":"Кранэкс","category":"Ходовая часть","thumbnail":"https://i.imgur.com/ewuCfwC.jpg","images":["https://i.imgur.com/wcVOdDS.jpg","https://i.imgur.com/Ujg8Uee.jpg"]},{"id":32,"title":"Гусеничная цепь VM C","description":"Прямые поставки комплектующих для спецтехники брендов KMF, ITM, USCO более 10 лет и всегда имеет большой ассортимент продукции в наличии на своих складах.","price":810000,"stock":5,"baseVehicle":"Caterpillar","category":"Ходовая часть","thumbnail":"https://i.imgur.com/ewuCfwC.jpg","images":["https://i.imgur.com/wcVOdDS.jpg","https://i.imgur.com/Ujg8Uee.jpg"]},{"id":33,"title":"Отвал VM D","description":"Отвал – ключевой механизм любой бульдозерной машины. Изготовленный из стали повышенной прочности и имеющий изогнутый эргономичный профиль основной рабочий инструмент дает возможность быстро выполнять задачи различной сложности во время строительно-дорожных, коммунальных и других работ.","price":860000,"stock":9,"baseVehicle":"Doosan","category":"Бульдозерные отвалы","thumbnail":"https://i.imgur.com/U0zfprB.jpg","images":["https://i.imgur.com/6Qf1pem.jpg","https://i.imgur.com/qsOF72u.jpg"]},{"id":34,"title":"Ковш VM J","description":"Ковш применяется для разработки котлованов, карьеров в грунтах I-IV категорий и разгрузки сыпучих материалов, плотность до 1600 кг/м3 (песок, суглинок, растительный грунт, щебень).","price":27000,"stock":8,"baseVehicle":"John Deere","category":"Ковши экскаваторные","thumbnail":"https://i.imgur.com/TAHhLzs.jpg","images":["https://i.imgur.com/ZqT5tBa.jpg","https://i.imgur.com/wrHKJlY.jpg","https://i.imgur.com/sVC1Nv9.jpg","https://i.imgur.com/P3lwyYJ.jpg","https://i.imgur.com/p03QHwR.jpg"]},{"id":35,"title":"Оси, пальцы втулки VM L","description":"Пальцы (оси) для экскаваторов строительного класса (эксплуатационной массой до 75 тонн) производятся из стали 40Х.","price":70000,"stock":5,"baseVehicle":"Liebherr","category":"Оси, втулки","thumbnail":"https://i.imgur.com/cyO8AIx.jpg","images":["https://i.imgur.com/4kb2ISw.jpg","https://i.imgur.com/rVutm8s.jpg"]},{"id":36,"title":"Оси, пальцы втулки VM D","description":"Пальцы (оси) для экскаваторов строительного класса (эксплуатационной массой до 75 тонн) производятся из стали 40Х.","price":770000,"stock":1,"baseVehicle":"Doosan","category":"Оси, втулки","thumbnail":"https://i.imgur.com/cyO8AIx.jpg","images":["https://i.imgur.com/4kb2ISw.jpg","https://i.imgur.com/rVutm8s.jpg"]},{"id":37,"title":"Рабочее оборудование VM D","description":"Стандартное навесное оборудование необходимо для выполнения операций с грунтами средней плотности. ","price":850000,"stock":1,"baseVehicle":"Doosan","category":"Стрелы, рукояти","thumbnail":"https://i.imgur.com/VCrzjYe.jpg","images":["https://i.imgur.com/hQkjGEx.jpg","https://i.imgur.com/P2HvbTG.jpg","https://i.imgur.com/AamO4HT.jpg"]},{"id":38,"title":"Гусеничная цепь VM D","description":"Прямые поставки комплектующих для спецтехники брендов KMF, ITM, USCO более 10 лет и всегда имеет большой ассортимент продукции в наличии на своих складах.","price":430000,"stock":3,"baseVehicle":"Doosan","category":"Ходовая часть","thumbnail":"https://i.imgur.com/ewuCfwC.jpg","images":["https://i.imgur.com/wcVOdDS.jpg","https://i.imgur.com/Ujg8Uee.jpg"]},{"id":39,"title":"Ковш VM H","description":"Ковш применяется для разработки котлованов, карьеров в грунтах I-IV категорий и разгрузки сыпучих материалов, плотность до 1600 кг/м3 (песок, суглинок, растительный грунт, щебень).","price":61000,"stock":2,"baseVehicle":"Hitachi","category":"Ковши экскаваторные","thumbnail":"https://i.imgur.com/TAHhLzs.jpg","images":["https://i.imgur.com/ZqT5tBa.jpg","https://i.imgur.com/wrHKJlY.jpg","https://i.imgur.com/sVC1Nv9.jpg","https://i.imgur.com/P3lwyYJ.jpg","https://i.imgur.com/p03QHwR.jpg"]},{"id":40,"title":"Ковш VM C","description":"Ковш применяется для разработки котлованов, карьеров в грунтах I-IV категорий и разгрузки сыпучих материалов, плотность до 1600 кг/м3 (песок, суглинок, растительный грунт, щебень).","price":94000,"stock":10,"baseVehicle":"Case","category":"Ковши экскаваторные","thumbnail":"https://i.imgur.com/TAHhLzs.jpg","images":["https://i.imgur.com/ZqT5tBa.jpg","https://i.imgur.com/wrHKJlY.jpg","https://i.imgur.com/sVC1Nv9.jpg","https://i.imgur.com/P3lwyYJ.jpg","https://i.imgur.com/p03QHwR.jpg"]}]'),o=class{constructor(t,e){this._componentElement=document.createElement("div"),this._isHidden=!1,this._productData=t,this._inCart=c.isInCart(this._productData.id),document.addEventListener("eventGeneral",(t=>this.updateState(t))),this.createElement(this._productData,e)}updateState(t){const e=t.detail?.category,s=t.detail?.baseVehicle,i=t.detail?.price,n=t.detail?.stock,c=t.detail.search?.trim().toLowerCase(),a=!e.length||e.includes(this._productData.category),r=!s.length||s.includes(this._productData.baseVehicle),o=!i||this._productData.price>=Number(i.slice(0,i.indexOf("-")))&&this._productData.price<=Number(i.slice(i.indexOf("-")+1)),m=!n||this._productData.stock>=Number(n.slice(0,n.indexOf("-")))&&this._productData.stock<=Number(n.slice(n.indexOf("-")+1)),p=this._productData.title.toLowerCase().includes(c)||this._productData.category.toLowerCase().includes(c)||this._productData.baseVehicle.toLowerCase().includes(c)||this._productData.price.toString().includes(c)||this._productData.stock.toString().includes(c);r&&a&&o&&m&&p?(this._componentElement.style.display="flex",this._isHidden=!1):(this._componentElement.style.display="none",this._isHidden=!0)}getComponent(){return this._componentElement}createElement(t,e){this._productData=t,this._componentElement.className="product","false"===e.get("viewGrid")?(this._componentElement.classList.add("product_wide"),this._componentElement.classList.remove("product_grid")):(this._componentElement.classList.remove("product_wide"),this._componentElement.classList.add("product_grid"));const s=document.createElement("div");s.className="product__img-wrapper";const i=new Image;t.thumbnail&&(i.src=t.thumbnail),i.className="product__img",s.append(i);const n=document.createElement("a");n.className="link product__link",n.href=`#products/${t.id}`,n.append(s);const a=document.createElement("p");a.className="product__title",a.textContent=t.title;const r=n.cloneNode(!1);r instanceof HTMLElement&&r.append(a);const o=document.createElement("p");o.className="product__category",o.textContent="Категория: "+t.category.toLowerCase();const m=document.createElement("p");m.className="product__price",m.textContent=String(t.price)+" руб.";const p=document.createElement("p");p.className="product__stock",p.textContent="В наличии: "+String(t.stock);const l=document.createElement("p");l.className="product__baseVehicle",l.textContent="Базовая машина: "+t.baseVehicle;const d=document.createElement("div");d.className="product_props",d.append(r,o,p,l);const u=document.createElement("button");u.textContent=this._inCart?"В корзине":"В корзину",u.className="button product__button",this._inCart&&u.classList.add("product__button_added"),u.addEventListener("click",(()=>{this._inCart?(u.textContent="В корзину",c.deleteItem(this._productData.id),u.classList.remove("product__button_added"),this._inCart=!1):(u.classList.add("product__button_added"),c.addItem(this._productData),u.textContent="В корзине",this._inCart=!0)}));const h=document.createElement("div");h.className="product__price-btn",h.append(m,u),this._componentElement.dataset.price=String(t.price),this._componentElement.dataset.stock=String(t.stock),this._componentElement.dataset.category=String(t.category),this._componentElement.dataset.baseVehicle=String(t.baseVehicle),this._componentElement.append(n,d,h)}};(new class{constructor(){this._componentElement=document.createElement("main"),this._footer=new class{constructor(){this._componentElement=document.createElement("footer"),this.createComponent()}getComponent(){return this._componentElement}createComponent(){this._componentElement.className="footer";const t=new Date,e=s(278),i=s(84),n=s(80);s(866),this._componentElement.append(this.createPerson(i,"misha","https://github.com/wave103x"),this.createPerson(e,t.getFullYear().toString(),"https://rs.school/js/"),this.createPerson(n,"vlad","https://github.com/nimboo1"))}createPerson(t,e,s){const i=document.createElement("div"),n=new Image;n.className="footer__person-logo",n.src=t;const c=document.createElement("p");c.className="footer__person-name",c.textContent=e;const a=document.createElement("a");return a.className="footer__person",a.href=s,a.append(n,c),i.append(a),i}},window.addEventListener("hashchange",(()=>this.renderContent())),this._cart=new c,c.setValues(),this._catalogue=(new class{constructor(){this.TAG_MAIN="main",this.CLASS_MAIN="main-catalogue",this.filterGeneral=new class{constructor(){this._category=[],this._baseVehicle=[],this._price="",this._stock="",this._search="",document.addEventListener("baseVehicle",(t=>{this.baseHandler.call(this,t)})),document.addEventListener("category",(t=>this.categoryHandler.call(this,t))),document.addEventListener("price",(t=>this.priceHandler.call(this,t))),document.addEventListener("stock",(t=>this.stockHandler.call(this,t))),document.addEventListener("search",(t=>this.searchHandler.call(this,t)))}generateEvent(){const t=new CustomEvent("eventGeneral",{detail:{category:this._category,baseVehicle:this._baseVehicle,price:this._price,stock:this._stock,search:this._search}});document.dispatchEvent(t)}baseHandler(t){this._baseVehicle=t.detail?.baseVehicle,this.generateEvent()}categoryHandler(t){this._category=t.detail?.category,this.generateEvent()}priceHandler(t){this._price=t.detail?.price,this.generateEvent()}stockHandler(t){this._stock=t.detail?.stock,this.generateEvent()}searchHandler(t){this._search=t.detail?.search,this.generateEvent()}},this._componentElement=document.createElement("div"),this.productsContainer=document.createElement("div"),this.initialProducts=r,this.searchParams=new URLSearchParams(window.location.hash.slice(2)),window.addEventListener("hashchange",(()=>{this.searchParams=new URLSearchParams(window.location.hash.slice(2))}))}createComponent(){const t=document.createElement("div");t.className="products-with-topbar",this.createProducts([...this.initialProducts]);const e=document.createElement("p");e.className="message-no-products",e.textContent="Здесь ничего нет",e.hidden=!0,t.append(this.createTopBar(e),this.productsContainer,e);const s=document.createElement("div");s.className="products-with-filters",s.append(this.createFilters(),t);const i=document.createElement("div");return i.className="heading-search",i.append(this.createHeading("Навесное оборудование для спецтехники"),this.createSearch()),this._componentElement.append(i,s),this._componentElement.className=this.CLASS_MAIN,this.searchParams.toString(),document.dispatchEvent(new CustomEvent("eventGeneral",{detail:{category:this.searchParams.getAll("category")||[],baseVehicle:this.searchParams.getAll("baseVehicle")||[],price:this.searchParams.get("price")||"",stock:this.searchParams.get("stock")||"",search:this.searchParams.get("search")||""}})),this._componentElement}createHeading(t){const e=document.createElement("h1");return e.className="catalogue__h1",e.textContent=t,e}createSearch(){const t=document.createElement("form"),e=document.createElement("input"),s=document.createElement("button");s.style.opacity="0.5",t.setAttribute("method","get"),t.setAttribute("action",""),t.setAttribute("onsubmit","return false"),t.className="search",e.setAttribute("type","text"),e.setAttribute("name","search-text"),e.setAttribute("placeholder","Поиск по каталогу"),e.className="search__input";const i=new URLSearchParams(document.location.hash.slice(2)).get("search");return i&&(e.value=i.toString()),e.addEventListener("input",(()=>{e.value?s.style.opacity="1":s.style.opacity="0.5";const t=new URLSearchParams(document.location.hash.slice(2));t.set("search",e.value),window.location.hash="?"+t.toString();const i=new CustomEvent("search",{bubbles:!0,detail:{search:e.value}});e.dispatchEvent(i)})),document.addEventListener("eventGeneral",(t=>this.searchReset(t,e))),s.className="button search__btn",s.textContent="✖",s.addEventListener("click",(()=>{s.style.opacity="0.5",e.value="";const t=new URLSearchParams(document.location.hash.slice(2));t.delete("search"),window.location.hash="?"+t.toString();const i=new CustomEvent("search",{bubbles:!0,detail:{search:e.value}});e.dispatchEvent(i)})),t.append(e,s),t}searchReset(t,e){t.detail.reset&&(e.value="")}createTopBar(t){const e=document.createElement("section");e.className="topbar";const i=document.createElement("div"),n=this.createSelect(["Сначала дешевые","Сначала дорогие","Больше на складе","Меньше на складе"]);i.className="topbar__items-on-page",document.addEventListener("productsOnPage",(e=>{e instanceof CustomEvent&&(i.innerHTML='<span class="topbar-itemsOnPage__span">Товаров найдено:</span> '+e.detail,e.detail?t.hidden=!0:t.hidden=!1)}));const c=document.createElement("div");c.className="topbar__switch";const a=document.createElement("label"),r=document.createElement("input"),o=document.createElement("label"),m=document.createElement("input");o.className="topbar-switch-label",a.className="topbar-switch-label",r.setAttribute("name","view-switch"),r.setAttribute("type","radio"),r.className="topbar-switch-input","false"===this.searchParams.get("viewGrid")?r.checked=!0:m.checked=!0,r.addEventListener("change",(()=>{this.searchParams.set("viewGrid","false"),window.location.hash="?"+this.searchParams.toString(),this.productsContainer.classList.remove("products_grid"),this.productsContainer.classList.add("products_wide");for(const t of this.productsContainer.children)t.classList.add("product_wide"),t.classList.remove("product_grid")})),m.addEventListener("change",(()=>{this.searchParams.set("viewGrid","true"),window.location.hash="?"+this.searchParams.toString(),this.productsContainer.classList.add("products_grid"),this.productsContainer.classList.remove("products_wide");for(const t of this.productsContainer.children)t.classList.remove("product_wide"),t.classList.add("product_grid")})),m.setAttribute("name","view-switch"),m.setAttribute("type","radio"),m.setAttribute("checked","true"),m.className="topbar-switch-input";const p=new Image;p.className="topbar-switch-view__icon",p.src=s(120);const l=new Image;return l.className="topbar-switch-view__icon",l.src=s(354),a.append(r,p),o.append(m,l),c.append(o,a),e.append(n,i,c),e}createSelect(t){const e=document.createElement("select");e.className="topbar__select";const s=document.createElement("option");s.textContent="Сортировать",s.setAttribute("value",""),s.setAttribute("disabled","true"),s.setAttribute("selected","true"),e.append(s),e.addEventListener("change",(t=>this.selectHandle(t)));for(let s of t){const t=document.createElement("option");switch(t.textContent=s,t.setAttribute("value",s),e.append(t),this.searchParams.get("sort")){case"priceDesc":"Сначала дорогие"===t.textContent&&t.setAttribute("selected","true");break;case"priceAsc":"Сначала дешевые"===t.textContent&&t.setAttribute("selected","true");break;case"stockDesc":"Больше на складе"===t.textContent&&t.setAttribute("selected","true");break;case"stockAsc":"Меньше на складе"===t.textContent&&t.setAttribute("selected","true")}}return e}selectHandle(t){const e=t.target;if(e instanceof HTMLSelectElement){const t=Array.from(this.productsContainer.children);switch(e.value){case"Сначала дорогие":t.sort(((t,e)=>Number(e.dataset.price)-Number(t.dataset.price))).forEach((t=>this.productsContainer.append(t))),this.searchParams.set("sort","priceDesc"),window.location.hash="?"+this.searchParams.toString();break;case"Сначала дешевые":t.sort(((t,e)=>Number(t.dataset.price)-Number(e.dataset.price))).forEach((t=>this.productsContainer.append(t))),this.searchParams.set("sort","priceAsc"),window.location.hash="?"+this.searchParams.toString();break;case"Больше на складе":t.sort(((t,e)=>Number(e.dataset.stock)-Number(t.dataset.stock))).forEach((t=>this.productsContainer.append(t))),this.searchParams.set("sort","stockDesc"),window.location.hash="?"+this.searchParams.toString();break;case"Меньше на складе":t.sort(((t,e)=>Number(t.dataset.stock)-Number(e.dataset.stock))).forEach((t=>this.productsContainer.append(t))),this.searchParams.set("sort","stockAsc"),window.location.hash="?"+this.searchParams.toString();break;default:return}}}createProducts(t){switch(this.productsContainer.className="products","false"===this.searchParams.get("viewGrid")?(this.productsContainer.classList.remove("products_grid"),this.productsContainer.classList.add("products_wide")):(this.productsContainer.classList.add("products_grid"),this.productsContainer.classList.remove("products_wide")),this.searchParams.get("sort")){case"priceDesc":t.sort(((t,e)=>Number(e.price)-Number(t.price)));break;case"priceAsc":t.sort(((t,e)=>Number(t.price)-Number(e.price)));break;case"stockDesc":t.sort(((t,e)=>Number(e.stock)-Number(t.stock)));break;case"stockAsc":t.sort(((t,e)=>Number(t.stock)-Number(e.stock)))}for(let e=0;e<t.length;e++){const s=new o(t[e],this.searchParams).getComponent();this.productsContainer.append(s)}}createFilters(){return new class{constructor(t){this.products=t}createComponent(t){const e=document.createElement("sidebar");e.className="filters";const s=this.createFilter("checkbox",a.Category,this.products,t),i=this.createFilter("checkbox",a.BaseVehicle,this.products,t),n=this.createRange(a.Price,this.products,t),c=this.createRange(a.Stock,this.products,t),r=this.createButtons("reset"),o=this.createButtons("copy");return e.append(o,r,s,i,n,c),e}createRange(t,e,s){const i="price"===t?"Цена":"stock"===t?"На складе":null,n=document.createElement("div");n.className="filter filter_range";const c=document.createElement("p");c.textContent=i,c.className="filter__title";const a=e.map((e=>e[t]));a.sort(((t,e)=>t-e));const r=a[0],o=a[a.length-1],m=(Math.ceil((o-r)/50),document.createElement("input"));m.className="filter__range",m.setAttribute("type","range"),m.setAttribute("min",r.toString()),m.setAttribute("max",o.toString()),m.setAttribute("name","rangeL"),m.setAttribute("value",m.dataset.value||r.toString());const p=document.createElement("input");p.className="filter__range",p.setAttribute("type","range"),p.setAttribute("min",r.toString()),p.setAttribute("max",o.toString()),p.setAttribute("name","rangeR"),p.setAttribute("value",p.dataset.value||o.toString());const l=document.createElement("label");l.textContent=m.getAttribute("min"),m.addEventListener("input",(e=>this.rangeHandler(e,m,l,t,!1,r,o))),document.addEventListener("eventGeneral",(e=>this.filterConnect(e,t,m,l)));const d=document.createElement("label");d.textContent=p.getAttribute("max"),p.addEventListener("input",(e=>this.rangeHandler(e,p,d,t,!0,r,o))),document.addEventListener("eventGeneral",(e=>this.filterConnect(e,t,p,d)));const u=document.createElement("div");u.className="filter__labels",u.append(l,d);const h=document.createElement("div");return h.className="filter_ranges",h.append(m,p),n.append(c,u,h),n}rangeHandler(t,e,s,i,n,c,a){s.textContent=e.value;const r=new URLSearchParams(document.location.hash.slice(2)),o=r.get(i);let m=o?.toString().slice(0,o?.toString().indexOf("-"))||c.toString(),p=o?.toString().slice(o?.toString().indexOf("-")+1)||a.toString();n?p=e.value:m=e.value;const l=`${m}-${p}`;r.set(i,l),window.location.hash="?"+r.toString();const d=new CustomEvent(i,{detail:{[i]:l}});document.dispatchEvent(d)}createFilter(t,e,s,i){const n="category"===e?"Категория":"baseVehicle"===e?"Базовая машина":null,c=document.createElement("div");c.className="filter";const a=document.createElement("p");a.textContent=n,a.className="filter__title";let r=[...new Set(s.map((t=>t[e])))];const o=i.getAll(e);for(let s=0;s<r.length;s++){const i=document.createElement("label");i.className="filter-item__label","string"==typeof r[s]&&(i.textContent=r[s]);const n=document.createElement("input");n.setAttribute("type",t),n.setAttribute("name",e),n.setAttribute("value",r[s]),o.length&&(o.includes(n.value)?n.checked=!0:n.checked=!1),i.prepend(n),n.addEventListener("change",(t=>this.filterHandler(t,e))),document.addEventListener("eventGeneral",(t=>this.filterConnect(t,e,n,i))),c.append(i)}c.prepend(a);const m=new CustomEvent(e,{detail:{[e]:o}});return document.dispatchEvent(m),c}filterConnect(t,e,s,i){if(!(s instanceof HTMLInputElement))return;let n=this.products.filter((e=>t.detail.baseVehicle.includes(e.baseVehicle))),c=this.products.filter((e=>t.detail.category.includes(e.category)));n.length||(n=[...this.products]),c.length||(c=[...this.products]);const a=t.detail.price;let r=[...this.products];if(a){const t=a.slice(0,a.indexOf("-")),e=a.slice(a.indexOf("-")+1);r=this.products.filter((s=>s.price>=t&&s.price<=e))}const o=t.detail.stock;let m=[...this.products];if(o){const t=o.slice(0,o.indexOf("-")),e=o.slice(o.indexOf("-")+1);m=this.products.filter((s=>s.stock>=t&&s.stock<=e))}const p=t.detail?.search?.trim().toLowerCase();let l=[...this.products];p&&(l=this.products.filter((t=>t.title.toLowerCase().includes(p)||t.category.toLowerCase().includes(p)||t.baseVehicle.toLowerCase().includes(p)||t.price.toString().includes(p)||t.stock.toString().includes(p))));let d=n.filter((t=>c.includes(t)));d=d.filter((t=>r.includes(t))),d=d.filter((t=>m.includes(t))),d=d.filter((t=>l.includes(t)));const u=this.products.filter((t=>t[e]===i.textContent)).length.toString(),h=d.filter((t=>t[e]===i.textContent)).length.toString();i.dataset.qty=`${h}/${u}`;const g=[...new Set(d.map((t=>t.category)))],_=[...new Set(d.map((t=>t.baseVehicle)))];switch(s.name){case"category":g.includes(s.value)?i.classList.remove("filter_stealth"):i.classList.add("filter_stealth");break;case"baseVehicle":_.includes(s.value)?i.classList.remove("filter_stealth"):i.classList.add("filter_stealth");break;case"rangeL":if("price"===e){if(!d.length)break;const t=[...d].sort(((t,e)=>t.price-e.price))[0].price.toString();s.value=t,i.textContent=t}if("stock"===e){if(!d.length)break;const t=[...d].sort(((t,e)=>t.stock-e.stock))[0].stock.toString();s.value=t,i.textContent=t}break;case"rangeR":if("price"===e){if(!d.length)break;const t=[...d].sort(((t,e)=>e.price-t.price))[0].price.toString();s.value=t,i.textContent=t}if("stock"===e){if(!d.length)break;const t=[...d].sort(((t,e)=>e.stock-t.stock))[0].stock.toString();s.value=t,i.textContent=t}}if(t.detail?.reset){s.checked=!1;const t=new CustomEvent(e,{detail:{category:[],baseVehicle:[],price:"",stock:"",search:"",reset:!0}});document.dispatchEvent(t);const i=new CustomEvent("search",{detail:{search:"",reset:!0}});document.dispatchEvent(i)}const b=new CustomEvent("productsOnPage",{detail:d.length});document.dispatchEvent(b)}filterHandler(t,e){const s=t.target;if(!(s instanceof HTMLInputElement))return;const i=s.value,n=new URLSearchParams(document.location.hash.slice(2)),c=n.getAll(e)||[];switch(s.type){case"radio":c.length=0,c.push(i),n.set(e,i);break;case"checkbox":s.checked?c.push(i):c.splice(c.indexOf(i),1),n.delete(e),[...new Set(c)].forEach((t=>n.append(e,t)))}window.location.hash="?"+n.toString();const a=new CustomEvent(e,{detail:{[e]:c}});document.dispatchEvent(a)}createButtons(t){const e=document.createElement("button"),i=new Image;switch(t){case"reset":e.textContent="Сбросить фильтры",e.className="filter__btn filter_reset-btn",i.src=s(693),e.prepend(i),e.addEventListener("click",(()=>{window.location.hash="#?",document.dispatchEvent(new CustomEvent("eventGeneral",{detail:{category:[],baseVehicle:[],price:"",stock:"",search:"",reset:!0}}))}));break;case"copy":const t=document.createElement("span");t.textContent="Копировать URL",e.className="filter__btn filter_copy-btn",i.src=s(449),e.prepend(i,t),e.addEventListener("click",(()=>{navigator.clipboard.writeText(window.location.href),t.textContent="Успешно",setTimeout((()=>{t.textContent="Копировать URL"}),1e3)}))}return e}}(this.initialProducts).createComponent(this.searchParams)}}).createComponent()}init(){const t=new class{constructor(){this._cartSum=document.createElement("p"),this._logoDiv=document.createElement("div"),this._currentSum=c.productSummary,this._currentCount=c.productsCount,this._componentElement=document.createElement("header")}getComponent(){return this.createComponent(),this._componentElement}createComponent(){this._componentElement.append(this.createLogo(),this.createCart()),this._componentElement.className="header"}createLogo(){const t=document.createElement("div"),e=document.createElement("a");e.href="#";const i=new Image;return i.src=s(649),i.className="logo",e.append(i),t.append(e),t}createCart(){const t=document.createElement("div");t.className="cart";const e=document.createElement("a");e.href="#cart",this._cartSum.className="cart__amount",this._cartSum.textContent=this._currentSum.toString();const i=new Image;return i.src=s(978),this._logoDiv.className="cart__logo",this._logoDiv.dataset.cartCount=this._currentCount.toString(),this._logoDiv.append(i),e.append(this._logoDiv),t.append(this._cartSum,e),t}updateState(t,e){this._cartSum.textContent=t.toString(),this._logoDiv.dataset.cartCount=e.toString()}};this._cart.getHeader(t),this._componentElement.append(this._catalogue),this.renderContent(),document.body.append(t.getComponent(),this._componentElement,this._footer.getComponent())}renderContent(){const t=window.location.hash.slice(1),e=document.querySelector(".main-basket");switch(e&&e.remove(),this.contentToLoad&&this.contentToLoad.remove(),t.includes("?")?t.slice(0,t.indexOf("?")):t){case t.match(/products\/\d+/gi)?.at(0):this._catalogue.hidden=!0,this.contentToLoad=(new class{constructor(){this.TAG_MAIN="main",this._componentElement=document.createElement("div");const t=window.location.hash;this._id=Number(t.substring(t.indexOf("/")+1));const e=r.find((t=>t.id===this._id));this._product=e,document.title=this._product.title,this._inCart=c.isInCart(this._product.id),this.createComponent()}getComponent(){return this._componentElement}createComponent(){this._componentElement.className="main-product";const t=this.createBreadcrumbs(),e=document.createElement("div");e.className="photos-description";const s=this.createPhotos(),i=this.createDescription();e.append(s,i),this._componentElement.append(t,e)}createPhotos(){const t=document.createElement("div");t.className="photos";const e=document.createElement("div");e.className="photos__viewer";const s=new Image;s.className="photos-viewer__img",e.append(s);const i=document.createElement("div");i.className="photos__thumbs";const n=this._product.images;return n?(n.forEach(((t,e)=>{const n=new Image;n.src=t,n.className="photos__thumb",i.append(n),0===e&&(n.classList.add("photos__thumb_hover"),s.src=t),n.addEventListener("mouseover",(()=>{s.src=t,Array.from(i.children).forEach((t=>t.classList.remove("photos__thumb_hover"))),n.classList.add("photos__thumb_hover")}))})),t.append(i,e),t):document.createElement("div")}createDescription(){const t=document.createElement("div");t.className="description";const e=document.createElement("p");e.textContent="Арт. "+this._product.id.toString(),e.className="description__artikul";const s=document.createElement("h1");s.className="description__title",s.textContent=`${this._product.title} на технику ${this._product.baseVehicle}`;const i=document.createElement("p");i.textContent=this._product.price.toString()+" руб.",i.className="description__price";const n=document.createElement("p");n.className="description__aviability",n.textContent=this._product.stock>0?"Доступно для заказа":"Нет в наличии";const a=document.createElement("p");a.textContent=this._product.description,a.className="description__text-description";const r=document.createElement("button");r.textContent=c.isInCart(this._product.id)?"В корзине":"В корзину",r.className="button description__to-cart",this._inCart&&r.classList.add("product__button_added"),r.addEventListener("click",(()=>{this._inCart?(r.textContent="В корзину",this._inCart=!1,c.deleteItem(this._product.id),r.classList.remove("product__button_added")):(this._inCart=!0,c.addItem(this._product),r.textContent="В корзине",r.classList.add("product__button_added"))}));const o=document.createElement("button");return o.className="button description__fast-buy",o.textContent="Быстрый заказ",o.addEventListener("click",(()=>{localStorage.setItem("doModale","true"),c.isInCart(this._product.id)||c.addItem(this._product),window.location.hash="#cart"})),t.append(e,s,i,n,r,o,a),t}createBreadcrumbs(){const t=document.createElement("div");return t.className="breadcrumbs",t.innerHTML=`<span>Catalogue</span> <span>${this._product.category}</span> <span>${this._product.baseVehicle}</span> <span>${this._product.title}</span>`,t}}).getComponent(),this._componentElement.append(this.contentToLoad);break;case"":this._catalogue.hidden=!1,document.title="Магазин навесного оборудования для вашей спецтехники.";break;case"cart":this._catalogue.hidden=!0,document.title="Корзина",this.contentToLoad=this._cart.createComponent(),this._componentElement.append(this.contentToLoad);break;default:this._catalogue.hidden=!0,document.title="ой! 404",this.contentToLoad=(new class{constructor(){this._componentElement=document.createElement("article")}createComponent(){return this._componentElement.append(this.createContainer()),this._componentElement.className="not-found",this._componentElement}createContainer(){const t=document.createElement("div");return t.append(this.createTitle(),this.createDescription(),this.createButton(),this.createImage()),t.className="not-found_container",t}createTitle(){const t=document.createElement("h2");return t.className="not-found_title",t.innerText="404",t}createDescription(){const t=document.createElement("p");return t.className="not-found_desc",t.innerText="Страница не найдена.",t}createButton(){const t=document.createElement("a");return t.classList.add("button"),t.classList.add("not-found_button"),t.innerText="Перейти на главную",t.setAttribute("href","#"),t}createImage(){const t=new Image;return t.src=s(585),t.classList.add("not-found_img"),t.setAttribute("alt","metr"),t}}).createComponent(),this._componentElement.append(this.contentToLoad)}}}).init()}()}();